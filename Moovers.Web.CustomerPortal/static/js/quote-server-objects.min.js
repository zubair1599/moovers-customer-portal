(function(){var n;this.PagedResult=function(){function n(n){$.extend(this,n)}return n}(),this.Quote=function(){function n(n){var t,i;t=this,$.extend(this,n),this.IsHourly=Utility.parseBool(n.IsHourly),i=["Scheduled","Open","Deferred","Lost"],i.forEach(function(n){return t[n]=t.Status===n})}return n.prototype.active=function(){return this.Status!=="Won"&&this.Status!=="Lost"},n}(),this.QuoteComment=function(){function n(n){var t;n=n!=null?n:{},this.Text=n.Text,this.UserName=n.UserName,this.IsEditable=n.IsEditable,this.CommentID=(t=n.CommentID)!=null?t:Utility.randomid(),this.Date=n.Date&&!n.Date.getDate?new Date(n.Date):n.Date}return n.prototype.GetDateString=function(){return(new Date).toDateString()===this.Date.toDateString()?prettyDate(this.Date):this.Date.format("mmm d, yyyy' at 'h:MM TT")},n.prototype.getCommentClass=function(){return SERVER.username===this.UserName?"logged-in-user":""},n}(),this.Stop=function(){function n(n){this.id=n.id||Utility.randomid(),$.extend(this,n),this.walkDistance=parseInt(n.walkDistance,10),this.outsideStairsCount=parseInt(n.outsideStairsCount,10)||0,this.insideStairsCount=parseInt(n.insideStairsCount,10)||0,this.floor=parseInt(n.floor,10)||0,this.apartmentComplex=n.apartmentComplex||"",this.apartmentGateCode=n.apartmentGateCode||"",this.liftgate=Utility.parseBool(n.liftgate),this.dock=Utility.parseBool(n.dock),this.storageDays=n.storageDays||null,this.verified&&(this.verifiedAddress=n.verifiedAddress),this.address=new Address(this.street1,this.street2,this.city,this.state,this.zip,this.addressid)}return n.prototype.addressTypeDisplay=function(){return AddressTypes[this.addressType]},n.prototype.parkingTypeDisplay=function(){return ParkingTypes[this.parkingType]},n.prototype.insideStairsTypeDisplay=function(){return StairTypes[this.insideStairsType]},n.prototype.outsideStairsTypeDisplay=function(){return StairTypes[this.outsideStairsType]},n.prototype.elevatorTypeDisplay=function(){return ElevatorTypes[this.elevatorType]},n.prototype.storageDaysDisplay=function(){switch(!1){case!((this.storageDays||0)<=0):return"";case!(this.storageDays===1):return"1 Day Storage";case!(this.storageDays<9999):return""+this.storageDays+" Days Storage";default:return"Storage > 7 days"}},n}(),this.Item=function(){function t(t){$.extend(this,t),this.AdditionalQuestions=_.map(t.AdditionalQuestions,function(t){return new n(t)})}return t}(),n=function(){function n(n){$.extend(this,n)}return n.prototype.getOptions=function(){return _.chain(this.Options).sortBy(function(n){return n.Sort}).value()},n}(),this.Room_Item_Rel=function(){function n(n){$.extend(this,n)}return n.prototype.renderTemplate=function(){return Inventory.templates.itemTemplate(this)},n.prototype.hasRelevantAdditionalInfo=function(){return this.AdditionalInfo?_.any(this.AdditionalInfo,function(n){return n.DisplayName!=="Frame"}):!1},n.prototype.getAdditionalDescription=function(){return _.chain(this.AdditionalInfo).filter(function(n){return n.DisplayName!=="Frame"&&n.DisplayName!=="None"}).pluck("DisplayName").value().join()},n}(),this.Room=function(){function n(n){n=n||{},this.Type=n.Type||"",this.Description=n.Description||"",this.Items=_.map(n.Items||[],function(n){return new Room_Item_Rel(n)}),this.StopID=n.StopID||"",this.StopName=n.StopName||"",this.RoomID=n.RoomID||Utility.randomid(),this.Pack=n.Pack||!1,this.Boxes=n.Boxes||[],this.Sort=n.Sort||0,this.IsUnassigned=n.IsUnassigned||!1}return n.prototype.addItem=function(n){return this.setItemCount(n,this.getQuantity(n)+1)},n.prototype.getItem=function(n){var t;return t=_(Inventory.currentRoom.Items).find(function(t){return t.Item.Name===n||t.Item.ItemID===n}),t&&t.Item?t:void 0},n.prototype.getRoomClass=function(){return Inventory.editable?"room":"room no-edit"},n.prototype.getItems=function(){return _.chain(this.Items).filter(function(n){return n.Count>0}).value()},n.prototype.setItemCount=function(n,t,i,r){var u,f;return i=i||0,u=_.find(this.Items,function(t){return t.Item.ItemID===n.ItemID}),u?(u.Count>0&&(r=u.AdditionalInfo),u.Count=t,u.StorageCount=i):(f=Math.max(_.max(_.pluck(this.Items,"Sort")),-1)+1,u=new Room_Item_Rel({Item:n,Count:t,StorageCount:i,Sort:f,IsBox:n.IsBox}),this.Items.push(u)),u.AdditionalInfo=r!=null?r:null,Inventory.setChanged(!0),this.retemplate(n)},n.prototype.renderBodyTemplate=function(n){var t,i;return t=Inventory.templates.roomBody,i=$.extend({},this,{divClass:n||"room"}),t(i)},n.prototype.renderUnassigned=function(){var n,t=this;return this.IsUnassigned?(n=_.chain(Inventory.rooms).filter(function(n){return!n.IsUnassigned}),n.map(function(n){return n.renderBodyTemplate("sub-room")}).value().join("")):""},n.prototype.moveItem=function(n,t){var i,r,u;return r=this.getQuantity(t)+n.getQuantity(t),u=this.getStorage(t)+n.getStorage(t),i=_.filter(this.Items,function(n){return n.Item.ItemID===t.ItemID}).AdditionalInfo,this.setItemCount(t,0),n.setItemCount(t,r,u,i)},n.prototype.retemplate=function(){var t,i,r,u,n,f,e,o;return e=Inventory.templates.roomMenu,u=Inventory.elements.roomMenu,n=$($.parseHTML($.trim(e(this)))),f=u.find(".room-selector[data-roomid="+this.RoomID+"]"),f.length>0?f.replaceWith(n):u.append(n),i=$($.parseHTML(this.renderBodyTemplate())),t=Inventory.elements.roomBody,r=t.find(".room[data-roomid="+this.RoomID+"]"),r.length>0?r.replaceWith(i):t.append(i),this.isSelected()&&(i.addClass("sel"),n.addClass("sel")),Inventory.initDraggable(t.find(".item[data-itemid]")),Inventory.initDroppable(n),this.IsUnassigned?void 0:(o=Inventory.getUnassignedRoom(),o.retemplate())},n.prototype.getQuantity=function(n){var t;return t=_.find(this.Items,function(t){return t.Item.ItemID===n.ItemID}),t?t.Count:0},n.prototype.getStorage=function(n){var t;return t=_.find(this.Items,function(t){return t.Item.ItemID===n.ItemID}),t?t.StorageCount:0},n.prototype.getItemCount=function(){var n;return n=this.Items,this.IsUnassigned&&(n=_.chain(Inventory.rooms).pluck("Items").flatten().value()),_.filter(n,function(n){return n.Count>0}).length},n.prototype.removeBox=function(n){if(n)return this.Boxes=_.reject(this.Boxes,function(t){return t.BoxTypeID===n.BoxTypeID})},n.prototype.setBoxCount=function(n,t){return this.removeBox(n),this.Boxes.push({BoxTypeID:n.BoxTypeID,Count:t,Name:n.Name})},n.prototype.deleteItems=function(){return this.Items.empty()},n.prototype.miniItemList=function(){var n;return n=$.extend({},this),n.Items=n.Items.map(function(n){var t;return t=$.extend({},n),t.Item={ItemID:n.Item.ItemID},t}),n},n.prototype.isSelected=function(){return Inventory.currentRoom&&this.RoomID===Inventory.currentRoom.RoomID},n}()}).call(this)